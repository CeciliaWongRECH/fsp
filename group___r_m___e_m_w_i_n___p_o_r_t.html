<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>RA Flexible Software Package Documentation: SEGGER emWin Port (rm_emwin_port)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="fsp_customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_scaled.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">RA Flexible Software Package Documentation
   &#160;<span id="projectnumber">Release v1.1.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___r_m___e_m_w_i_n___p_o_r_t.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SEGGER emWin Port (rm_emwin_port)<div class="ingroups"><a class="el" href="group___r_e_n_e_s_a_s___m_o_d_u_l_e_s.html">Modules</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>SEGGER emWin port for RA MCUs. </p>
<h1><a class="anchor" id="rm-emwin-port-overview"></a>
Overview</h1>
<p><a class="anchor" id="um_emwin_port"></a> The SEGGER emWin RA Port module provides the configuration and hardware acceleration support necessary for use of emWin on RA products. The port provides full integration with the graphics peripherals (GLCDC, DRW and JPEG) as well as FreeRTOS.</p>
<dl class="section note"><dt>Note</dt><dd>This port layer primarily enables hardware acceleration and background handling of many display operations and does not contain code intended to be directly called by the user. Please consult the SEGGER emWin User Guide (UM03001) for details on how to use emWin in your project.</dd></dl>
<h2><a class="anchor" id="rm-emwin-port-hw-accel"></a>
Hardware Acceleration</h2>
<p>The following functions are currently performed with hardware acceleration:<a class="anchor" id="um_emwin_drw_acceleration"></a><a class="anchor" id="um_emwin_jpeg_acceleration"></a></p><ul>
<li>DRW Engine (r_drw)<ul>
<li>Drawing bitmaps (ARGB8888 and RGB565)</li>
<li>Rectangle fill</li>
<li>Line and shape drawing</li>
<li>Anti-aliased operations<ul>
<li>Circle stroke and fill</li>
<li>Polygon stroke and fill</li>
<li>Lines and arcs</li>
</ul>
</li>
</ul>
</li>
<li>JPEG Codec (r_jpeg)<ul>
<li>JPEG decoding</li>
</ul>
</li>
<li>Graphics LCD Controller (r_glcdc)<ul>
<li>Brightness, contrast and gamma correction</li>
<li>Pixel format conversion (framebuffer to LCD)</li>
</ul>
</li>
</ul>
<hr/>
<h1><a class="anchor" id="rm-emwin-port-configuration"></a>
Configuration</h1>
<p><h2>Build Time Configurations for rm_emwin_port</h2>
The following build time configurations are defined in fsp_cfg/rm_emwin_port_cfg.h:<br />
</p><table class="doxtable">
<tr>
<th>Configuration</th><th>Options</th><th>Default</th><th>Description </th></tr>
<tr>
<td>Memory Allocation &gt; GUI Heap Size</td><td>Value must be a non-negative integer</td><td>32768 </td><td>Set the size of the heap to be allocated for use exclusively by emWin. </td></tr>
<tr>
<td>Memory Allocation &gt; Section for GUI Heap</td><td>Manual Entry</td><td>.noinit </td><td>Specify the section in which to allocate the GUI heap. </td></tr>
<tr>
<td>Memory Allocation &gt; Maximum Layers</td><td>Value must be a non-negative integer</td><td>16 </td><td>Set the maximum number of available display layers in emWin.<br />
<br />
This setting is not related to GLCDC Layer 1 or 2. </td></tr>
<tr>
<td>Memory Allocation &gt; AA Font Conversion Buffer Size</td><td>Value must be a non-negative integer</td><td>400 </td><td>Set the size of the conversion buffer for anti-aliased font glyphs. This should be set to the size (in bytes) of the largest AA character to be rendered. </td></tr>
<tr>
<td>Configuration &gt; Multi-thread Support</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>Enable or disable multithreading support. </td></tr>
<tr>
<td>Configuration &gt; Number of emWin-supported threads</td><td>Manual Entry</td><td>5 </td><td>If multithreading support is enabled this configuration specifies the number of different tasks that can call emWin functions. </td></tr>
<tr>
<td>Configuration &gt; Touch Panel Support</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>Enable or disable touch panel support. </td></tr>
<tr>
<td>Configuration &gt; Mouse Support</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Disabled </td><td>Enable or disable support for mouse input. </td></tr>
<tr>
<td>Configuration &gt; Memory Devices</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>Enable or disable support for memory devices, which allow the user to allocate their own memory in the GUI heap. </td></tr>
<tr>
<td>Configuration &gt; Text Rotation</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Disabled </td><td>Enable or disable support for displaying rotated text. </td></tr>
<tr>
<td>Configuration &gt; Window Manager</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>Enable or disable the emWin Window Manager (WM). </td></tr>
<tr>
<td>Configuration &gt; Bidirectional Text</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Disabled </td><td>Enable or disable support for bidirectional text (such as Arabic or Hebrew). </td></tr>
<tr>
<td>Configuration &gt; Debug Logging Level</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
None (0)</li>
<li>
Parameter checking only (1)</li>
<li>
All checks enabled (2)</li>
<li>
Log errors (3)</li>
<li>
Log warnings (4)</li>
<li>
Log all messages (5)</li>
</ul>
</td><td>All checks enabled (2) </td><td>Set the debug logging level. </td></tr>
<tr>
<td>LCD Settings &gt; Wait for Vertical Sync</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Enabled </td><td>When enabled emWin will wait for a vertical sync event each time the display is updated. If an RTOS is used the thread will yield; otherwise each frame will block until Vsync.<br />
<br />
WARNING: Disabling vertical sync will result in tearing. It is recommended to always leave this setting Enabled if an RTOS is used. </td></tr>
<tr>
<td>JPEG Decoding &gt; General &gt; Input Alignment</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
8-byte aligned (faster)</li>
<li>
Unaligned (slower)</li>
</ul>
</td><td>Unaligned (slower) </td><td>Setting this option to 8-bit alignment can allow the hardware JPEG Codec to directly read JPEG data. This speeds up JPEG decoding operations and reduces RAM overhead, but all JPEG images must reside on an 8-byte boundary.<br />
<br />
When this option is enabled the input buffer is not allocated. </td></tr>
<tr>
<td>JPEG Decoding &gt; General &gt; Double-Buffer Output</td><td><ul style="margin-top:0;margin-bottom:0;">
<li>
Enabled</li>
<li>
Disabled</li>
</ul>
</td><td>Disabled </td><td>Enable this option to configure JPEG decoding operations to use a double-buffered output pipeline. This allows the JPEG to be rendered to the display at the same time as decoding at the cost of additional RAM usage.<br />
<br />
Enabling this option automatically allocates double the output buffer size. </td></tr>
<tr>
<td>JPEG Decoding &gt; General &gt; Error Timeout</td><td>Value must be a non-negative integer</td><td>50 </td><td>Set the timeout for JPEG decoding operations (in RTOS ticks) in the event of a decode error. </td></tr>
<tr>
<td>JPEG Decoding &gt; Buffers &gt; Input Buffer Size</td><td>Value must be a non-negative integer</td><td>0x1000 </td><td>Set the size of the JPEG decode input buffer (in bytes). This buffer is used to ensure 8-byte alignment of input data. Specifying a size smaller than the size of the JPEG to decode will use additional interrupts to stream data in during the decoding process. </td></tr>
<tr>
<td>JPEG Decoding &gt; Buffers &gt; Output Buffer Size</td><td>Value must be a non-negative integer</td><td>0x3C00 </td><td>Set the size of the JPEG decode output buffer (in bytes). An output buffer smaller than the size of a decoded image will use additional interrupts to stream the data into a framebuffer.<br />
<br />
Unless you are sure of the subsampling used in and the size of the input JPEG images it is recommended to allocate at least 16 framebuffer lines of memory. </td></tr>
<tr>
<td>JPEG Decoding &gt; Buffers &gt; Section for Buffers</td><td>Manual Entry</td><td>.noinit </td><td>Specify the section in which to allocate the JPEG work buffers. </td></tr>
</table>
</p>
<h2><a class="anchor" id="rm-emwin-port-hw-config"></a>
Hardware Configuration</h2>
<p>No clocks or pins are directly required by this module. Please consult the submodules' documentation for their requirements. </p><hr/>
<h1><a class="anchor" id="rm-emwin-port-usage_notes"></a>
Usage Notes</h1>
<h2><a class="anchor" id="rm-emwin-port-getting_started"></a>
Getting Started</h2>
<p>To get started with emWin in an RA project the following must be performed:</p>
<ol type="1">
<li>Open the RA Configuration editor for your project</li>
<li>Add emWin to your project in the Stacks view by clicking <b>New Stack -&gt; SEGGER -&gt; SEGGER emWin</b></li>
<li>Ensure the configuration options for emWin are set as necessary for your application</li>
<li>Set the proporties for the GLCDC module to match the timing and memory requirements of your display panel</li>
<li>Set the JPEG decode color depth to the desired value (if applicable)</li>
<li>Ensure interrupts on all modules are enabled:<ul>
<li>GLCDC Vertical Position (Vpos) Interrupt</li>
<li>DRW Interrupt (if applicable)</li>
<li>JPEG Encode/Decode and Data Transfer Interrupts (if applicable)</li>
</ul>
</li>
<li>Click Generate Project Content to save and commit configuration changes</li>
<li>(Non-RTOS projects only) Before calling GUI_Init, call g_hal_init to initialize the framebuffer address.</li>
</ol>
<p>At this point the project is now ready to build with emWin. Please refer to the SEGGER emWin User Guide (UM03001) as well as demo and sample code for details on how to create a GUI application.</p>
<h2>Using Hardware Acceleration</h2>
<p>In most cases there is no need to perform additional configuration to ensure the DRW Engine is used. However, there are some guidelines that should be followed depending on the item in question:</p>
<ul>
<li>Bitmaps:<ul>
<li>ARGB8888, RGB888 and RGB565 bitmaps require no additional settings.</li>
</ul>
</li>
<li>Anti-aliased shapes:<ul>
<li>Anti-aliased lines, circles, polygons, polygon outlines and arcs are rendered with the DRW Engine.</li>
</ul>
</li>
<li>Anti-aliased (4bpp) fonts:<ul>
<li>Set the text mode to GUI_TM_TRANS or create the relevant widget with WM_CF_HASTRANS set.</li>
<li>Ensure the "AA Font Conversion Buffer Size" configuration option is set to a size equal to or greater than the size (in bytes) of the largest glyph.</li>
</ul>
</li>
<li>8bpp palletized images:<ul>
<li>When creating these images ensure transparency is not enabled as the SEGGER method for this is not compatible with the DRW Engine.</li>
</ul>
</li>
<li>RLE-encoded images:<ul>
<li>Hardware acceleration is not available for SEGGER's RLE format.</li>
</ul>
</li>
</ul>
<h2>Multi-thread Support</h2>
<p>When the "Multi-thread Support" configuration is enabled, emWin can be called from multiple threads. This comes with advantages and disadvantages:</p>
<p>Advantages:</p><ul>
<li>High flexibility in development of applications</li>
<li>Threads can pend and post on emWin events</li>
</ul>
<p>Disadvantages:</p><ul>
<li>Slightly higher RAM/ROM use</li>
<li>Large GUI projects can become difficult to debug</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Multi-thread support is independent of RTOS support. RTOS support is managed internally and cannot be manually configured.</dd></dl>
<h2><a class="anchor" id="rm-emwin-port-limitations"></a>
Limitations</h2>
<p>Developers should be aware of the following limitations when using SEGGER emWin with FSP:</p>
<ul>
<li>Hardware acceleration is not available when using color modes lower than 16 bits.</li>
<li>Support for rotated screen modes is in development.</li>
<li>Hardware acceleration is not available for SEGGER's RLE image format.</li>
</ul>
<hr/>
<h1><a class="anchor" id="rm-emwin-port-examples"></a>
Examples</h1>
<h2><a class="anchor" id="rm-emwin-port-examples-minimal"></a>
Basic Example</h2>
<p>This is a basic example demonstrating a very simple emWin application. The screen is cleared to white and "Hello World!" is printed in the center.</p>
<dl class="section note"><dt>Note</dt><dd>emWin manages the GLCDC, DRW and JPEG Codec submodules internally; they do not need to be opened directly.</dd></dl>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;DIALOG.h&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define COLOR_WHITE       0x00FFFFFFU</span></div><div class="line"><span class="preprocessor">#define COLOR_BLACK       0x00000000U</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define GUI_DRAW_DELAY    100</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> _cbMain (WM_MESSAGE * pMsg)</div><div class="line">{</div><div class="line">    GUI_RECT Rect;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (pMsg-&gt;MsgId)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">case</span> WM_CREATE:</div><div class="line">        {</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> WM_PAINT:</div><div class="line">        {</div><div class="line">            <span class="comment">/* Clear background to white */</span></div><div class="line">            GUI_SetBkColor(COLOR_WHITE);</div><div class="line">            GUI_Clear();</div><div class="line"></div><div class="line">            <span class="comment">/* Draw &quot;Hello World!&quot; in black in the center */</span></div><div class="line">            WM_GetClientRect(&amp;Rect);</div><div class="line">            GUI_SetColor(COLOR_BLACK);</div><div class="line">            GUI_DispStringInRect(<span class="stringliteral">&quot;Hello World!&quot;</span>, &amp;Rect, GUI_TA_VCENTER | GUI_TA_HCENTER);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">        {</div><div class="line">            WM_DefaultProc(pMsg);</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> emWinTask (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    int32_t xSize;</div><div class="line">    int32_t ySize;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize emWin */</span></div><div class="line">    GUI_Init();</div><div class="line"></div><div class="line">    <span class="comment">/* Get screen dimensions */</span></div><div class="line">    xSize = LCD_GetXSize();</div><div class="line">    ySize = LCD_GetYSize();</div><div class="line"></div><div class="line">    <span class="comment">/* Create main window */</span></div><div class="line">    WM_CreateWindowAsChild(0, 0, xSize, ySize, WM_HBKWIN, WM_CF_SHOW, _cbMain, 0);</div><div class="line"></div><div class="line">    <span class="comment">/* Enter main drawing loop */</span></div><div class="line">    <span class="keywordflow">while</span> (1)</div><div class="line">    {</div><div class="line">        GUI_Delay(GUI_DRAW_DELAY);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>For further example code please consult SEGGER emWin documentation, which can be downloaded <a href="http://www.renesas.com/fsp#downloads">here</a>, as well as the Quick Start Guide and example project(s) provided with your Evaluation Kit (if applicable).</dd></dl>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
        <li class="footer">FSP Release v1.1.0 User's Manual Copyright © (2020) Renesas Electronics Corporation. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
